{
  "meta": {
    "project": "TVDoutor ADS Web Application",
    "date": "2026-01-15",
    "prepared_by": "Generated by TestSprite"
  },
  "product_overview": "TVDoutor ADS is a comprehensive web application that manages advertising proposals, campaigns, inventory, user roles, geospatial data visualization, and reporting. It supports workflow automation for proposal creation, role-based access control, interactive mapping with heatmaps, and PDF generation for reports and proposals.",
  "core_goals": [
    "Provide secure authentication and role-based access control.",
    "Enable users to create, view, and manage advertising proposals through a guided wizard.",
    "Allow management of advertising campaigns and venues with detailed tracking.",
    "Maintain an inventory system for screens including image uploads.",
    "Deliver interactive maps with filtering and geospatial heatmap visualization.",
    "Offer comprehensive reports and analytics with PDF export capability.",
    "Support administration of users and impact models with fine-grained permission controls.",
    "Ensure system reliability through thorough testing across critical business and security flows."
  ],
  "key_features": [
    "Authentication and role-based authorization integrating Supabase Auth.",
    "Proposal wizard for creation, validation, saving, and PDF generation.",
    "Campaigns and venues management including linking venues to campaigns.",
    "Inventory of screens with upload and validation of images.",
    "Interactive map pages with geospatial points and heatmap functionality using Mapbox GL and Leaflet.",
    "Agency and project management with association of people to projects.",
    "Dashboard displaying key metrics with live backend data refresh.",
    "Reports generation with filtering and export options including PDF.",
    "Email notification system for transactional communication.",
    "User and impact model administration with access control and role management."
  ],
  "user_flow_summary": [
    "User logs in and is granted access based on their role.",
    "User navigates through dashboard viewing real-time metrics.",
    "User creates a new proposal via the proposal wizard, validates inputs, saves it, and generates a PDF.",
    "Manager-level user creates or edits campaigns and links venues.",
    "Inventory managers upload and validate new screen images.",
    "Users explore interactive maps and apply filters to see heatmap data.",
    "Admin users manage users, roles, and impact models.",
    "Users generate reports with filters and export them as PDFs.",
    "Users update their profile and change passwords with validation.",
    "Role-based access control restricts unauthorized access to protected routes."
  ],
  "validation_criteria": [
    "Successful login and role-based access control enforcement for all roles including user, client, manager, admin, and super_admin.",
    "Proposal wizard prevents advancing without mandatory field completion and successfully saves data.",
    "Generated PDFs for proposals and reports match layout requirements without errors.",
    "Maps load correctly with points displayed, filtering works, and heatmaps render aggregated data.",
    "Image uploads in inventory enforce file type and size constraints with error feedback.",
    "Creation and editing of campaigns, venues, agencies, and projects function without error.",
    "Reports generate correctly based on filters and support export to defined formats.",
    "Profile updates and password changes validate and persist correctly.",
    "Role-based blocking of unauthorized route access is enforced and tested for each role.",
    "No blocking errors occur during critical P0 workflows and at least 95% of P0/P1 test cases are executed successfully."
  ],
  "code_summary": {
    "tech_stack": [
      "TypeScript",
      "React 18",
      "Vite",
      "Tailwind CSS",
      "shadcn/ui",
      "Radix UI",
      "Supabase (Auth, Database, Storage)",
      "Mapbox GL",
      "Leaflet + Heatmap",
      "Recharts",
      "html2pdf.js",
      "Puppeteer",
      "React Query",
      "React Hook Form",
      "Zod"
    ],
    "features": [
      {
        "name": "Auth and roles",
        "description": "Autenticacao e controle de acesso por role via Supabase.",
        "files": [
          "src/contexts/AuthContext.tsx",
          "src/components/ProtectedRoute.tsx",
          "src/lib/auth.ts"
        ]
      },
      {
        "name": "Routing and pages",
        "description": "Rotas principais e paginas do app.",
        "files": [
          "src/App.tsx",
          "src/pages/Login.tsx",
          "src/pages/ResetPassword.tsx",
          "src/pages/Index.tsx",
          "src/pages/NewProposal.tsx",
          "src/pages/Propostas.tsx",
          "src/pages/ProposalDetails.tsx",
          "src/pages/InteractiveMap.tsx",
          "src/pages/Inventory.tsx",
          "src/pages/Reports.tsx",
          "src/pages/Venues.tsx",
          "src/pages/Campaigns.tsx",
          "src/pages/Agencias.tsx",
          "src/pages/AgenciasProjetos.tsx",
          "src/pages/ProjectManagement.tsx",
          "src/pages/PessoasProjeto.tsx",
          "src/pages/UserManagement.tsx",
          "src/pages/ImpactModelsAdmin.tsx",
          "src/pages/HeatmapPage.tsx",
          "src/pages/Profile.tsx",
          "src/pages/Settings.tsx"
        ]
      },
      {
        "name": "Proposals and wizard",
        "description": "Criacao, validacao e detalhes de propostas.",
        "files": [
          "src/components/NewProposalWizardImproved.tsx",
          "src/components/wizard/ProposalWizardSteps.tsx",
          "src/lib/proposta-service.ts",
          "src/lib/proposal-normalizer.ts",
          "src/utils/validations/proposal.ts",
          "src/utils/validations/proposal-wizard.ts"
        ]
      },
      {
        "name": "Campaigns and venues",
        "description": "Gestao de campanhas e venues.",
        "files": [
          "src/lib/project-management-service.ts",
          "src/pages/Campaigns.tsx",
          "src/pages/CampaignDetails.tsx",
          "src/pages/Venues.tsx",
          "src/pages/VenueDetails.tsx"
        ]
      },
      {
        "name": "Inventory and screens",
        "description": "Inventario de telas e armazenamento de imagens.",
        "files": [
          "src/pages/Inventory.tsx",
          "src/lib/screen-service.ts",
          "src/lib/screen-fallback-service.ts",
          "src/lib/storage.ts"
        ]
      },
      {
        "name": "Maps and heatmap",
        "description": "Mapa interativo e heatmap geoespacial.",
        "files": [
          "src/pages/InteractiveMap.tsx",
          "src/pages/HeatmapPage.tsx",
          "src/components/HeatmapTest.tsx",
          "src/lib/leaflet-config.ts",
          "src/lib/geocoding.ts",
          "src/lib/location-service.ts"
        ]
      },
      {
        "name": "Agencies and projects",
        "description": "Cadastro de agencias, projetos e pessoas por projeto.",
        "files": [
          "src/pages/Agencias.tsx",
          "src/pages/AgenciasProjetos.tsx",
          "src/pages/ProjectManagement.tsx",
          "src/pages/PessoasProjeto.tsx",
          "src/lib/agencia-service.ts",
          "src/lib/pessoas-projeto-service.ts"
        ]
      },
      {
        "name": "Reports and analytics",
        "description": "Relatorios, filtros e dados de dashboard.",
        "files": [
          "src/pages/Reports.tsx",
          "src/lib/dashboard-service.ts",
          "src/lib/search-service.ts",
          "src/hooks/useDashboardStats.ts",
          "src/hooks/useRevenueData.ts"
        ]
      },
      {
        "name": "Email and notifications",
        "description": "Envio e processamento de emails.",
        "files": [
          "src/lib/email-service.ts"
        ]
      },
      {
        "name": "PDF generation",
        "description": "Geracao de PDF para propostas e relatorios.",
        "files": [
          "src/lib/pdf-service.ts",
          "src/lib/pdf.ts",
          "src/hooks/use-html2pdf.ts",
          "src/styles/pdf.css"
        ]
      },
      {
        "name": "User administration",
        "description": "Gestao de usuarios e modelos de impacto.",
        "files": [
          "src/pages/Users.tsx",
          "src/pages/UserManagement.tsx",
          "src/pages/ImpactModelsAdmin.tsx",
          "src/lib/admin-operations.ts",
          "src/lib/impact-models-service.ts"
        ]
      }
    ]
  }
}
